#!/usr/bin/env qore
# -*- mode: qore; indent-tabs-mode: nil -*-

%new-style
%enable-all-warnings
%require-types
%strict-args

%requires ../../../../../qlib/Util.qm
%requires ../../../../../qlib/QUnit.qm

%exec-class SerializableTest

class Base inherits Serializable {
    public {
        int x = 2;
    }

    private:internal {
        int i = 2;
    }

    int get() {
        return x;
    }
}

class T inherits Serializable, private:internal Base {
    public {
        int i = 1;
    }

    private {
        string str = "test";
    }

    private:internal {
        bool flag = False;
    }

    int get() {
        return Base::get();
    }
}

class SerializableTest inherits QUnit::Test {
    constructor() : QUnit::Test("Serializable", "1.0") {
        addTestCase("SerializableTest", \serializableTest());
        set_return_value(main());
    }

    serializableTest() {
        T t();
        printf("%y\n", t.get());
        hash<SerializationInfo> h = t.serializeToData();
        printf("%N\n", h);
    }
}
